(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83753,e=>{"use strict";let t=(0,e.i(24929).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],83753)},72142,e=>{"use strict";let t=(0,e.i(24929).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],72142)},24929,e=>{"use strict";var t=e.i(4);let r=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:n="",children:o,iconNode:c,...d},u)=>(0,t.createElement)("svg",{ref:u,...a,width:s,height:s,stroke:e,strokeWidth:i?24*Number(l)/Number(s):l,className:r("lucide",n),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),i=(e,a)=>{let i=(0,t.forwardRef)(({className:i,...n},o)=>(0,t.createElement)(l,{ref:o,iconNode:a,className:r(`lucide-${s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...n}));return i.displayName=s(e),i};e.s(["default",()=>i],24929)},33149,e=>{"use strict";let t="systracker_token",r="systracker_username",s="systracker_role";function a(){return localStorage.getItem(t)}function l(e,a,i="admin"){localStorage.setItem(t,e),localStorage.setItem(r,a),localStorage.setItem(s,i)}function i(){localStorage.removeItem(t),localStorage.removeItem(r),localStorage.removeItem(s)}function n(){return localStorage.getItem(r)}function o(){return localStorage.getItem(s)||"admin"}function c(){return"admin"===o()}function d(){return"viewer"===o()}function u(){let e=a();return!!e&&!function(e){try{let t=JSON.parse(atob(e.split(".")[1]));return 1e3*t.exp<Date.now()}catch{return!0}}(e)}async function m(e,t={}){let r=a();return fetch(e,{...t,headers:{"Content-Type":"application/json",...t.headers||{},...r?{Authorization:`Bearer ${r}`}:{}}})}e.s(["clearToken",()=>i,"fetchWithAuth",()=>m,"getRole",()=>o,"getToken",()=>a,"getUsername",()=>n,"isAdmin",()=>c,"isAuthenticated",()=>u,"isViewer",()=>d,"setToken",()=>l])},53097,e=>{"use strict";let t=(0,e.i(24929).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],53097)},16871,(e,t,r)=>{t.exports=e.r(57234)},84982,e=>{"use strict";let t=(0,e.i(24929).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],84982)},95196,e=>{"use strict";let t=(0,e.i(24929).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);e.s(["Zap",()=>t],95196)},99190,e=>{"use strict";var t=e.i(27493),r=e.i(4),s=e.i(16871),a=e.i(85506),l=e.i(95196),i=e.i(84982),n=e.i(72142),o=e.i(83753),c=e.i(53097);let d=(0,e.i(24929).default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var u=e.i(33149);function m(){let e=(0,s.useRouter)(),m=(0,s.useSearchParams)(),h=m.get("token"),x=m.get("email")||"",p=m.get("name")||"",b=x?x.split("@")[0].toLowerCase().replace(/[^a-z0-9_-]/g,""):p?p.toLowerCase().replace(/[^a-z0-9_-]/g,""):"",[g,f]=(0,r.useState)(b),[y,j]=(0,r.useState)("idle"),[v,w]=(0,r.useState)("");(0,r.useEffect)(()=>{h||e.replace("/login")},[h,e]);let k=async t=>{if(t.preventDefault(),!g.trim()){j("error"),w("Please enter a username");return}if(!/^[a-zA-Z0-9_-]{3,30}$/.test(g)){j("error"),w("Username must be 3-30 characters and contain only letters, numbers, underscores, or hyphens");return}j("loading"),w("");try{let t=await fetch("/api/auth/set-username",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify({username:g.trim()})}),r=await t.json();if(!t.ok){j("error"),w(r.error||"Failed to set username");return}(0,u.setToken)(r.token,r.username,"admin"),j("success"),setTimeout(()=>{e.replace("/dashboard?welcome=true")},1500)}catch{j("error"),w("Cannot reach server. Please try again.")}};return(0,t.jsxs)("div",{className:"min-h-screen bg-linear-to-br from-slate-900 via-blue-950 to-slate-900 flex items-center justify-center px-4 relative overflow-hidden",children:[(0,t.jsxs)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[(0,t.jsx)("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),(0,t.jsx)("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-cyan-500/10 rounded-full blur-3xl"}),(0,t.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-indigo-500/5 rounded-full blur-3xl"})]}),(0,t.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:64px_64px] pointer-events-none"}),(0,t.jsxs)("div",{className:"relative z-10 w-full max-w-md",children:[(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col items-center mb-10",children:[(0,t.jsx)("div",{className:"bg-linear-to-br from-blue-500 to-purple-600 text-white p-4 rounded-2xl shadow-2xl shadow-blue-500/50 mb-5 ring-4 ring-white/20",children:(0,t.jsx)(l.Zap,{size:36,fill:"currentColor",strokeWidth:2})}),(0,t.jsx)("h1",{className:"text-3xl font-extrabold bg-linear-to-r from-white via-blue-100 to-white bg-clip-text text-transparent",children:"Welcome to SysTracker!"}),(0,t.jsx)("p",{className:"text-slate-400 text-sm mt-2 font-medium",children:"One more step to get started"})]}),(0,t.jsxs)(a.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white/10 backdrop-blur-2xl border border-white/20 rounded-3xl p-10 shadow-[0_24px_48px_rgba(0,0,0,0.3)]",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Choose Your Username"}),(0,t.jsx)("p",{className:"text-slate-400 text-sm mb-7",children:"You'll use this to sign in to SysTracker. Choose something you'll remember!"}),(0,t.jsxs)("div",{className:"mb-6 p-4 bg-blue-500/10 border border-blue-500/30 rounded-xl flex items-start gap-3",children:[(0,t.jsx)(d,{size:18,className:"text-blue-400 shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"text-sm text-blue-300",children:[(0,t.jsx)("p",{className:"font-semibold mb-1",children:"Your account details:"}),(0,t.jsxs)("p",{className:"text-blue-400/80",children:["Email: ",x]}),p&&(0,t.jsxs)("p",{className:"text-blue-400/80",children:["Name: ",p]})]})]}),(0,t.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-300 mb-1.5",children:["Username ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.User,{size:16,className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-slate-500"}),(0,t.jsx)("input",{type:"text",required:!0,autoFocus:!0,value:g,onChange:e=>f(e.target.value),placeholder:"john_doe",className:"w-full pl-10 pr-4 py-3 rounded-xl bg-white/5 border border-white/10 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm",disabled:"loading"===y||"success"===y})]}),(0,t.jsx)("p",{className:"text-xs text-slate-500 mt-1.5",children:"3-30 characters â€¢ Letters, numbers, underscores, or hyphens"})]}),"error"===y&&(0,t.jsxs)(a.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center gap-2.5 p-3 bg-red-500/10 border border-red-500/30 rounded-xl text-red-400 text-sm",children:[(0,t.jsx)(n.AlertCircle,{size:16,className:"shrink-0"}),v]}),"success"===y&&(0,t.jsxs)(a.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center gap-2.5 p-3 bg-green-500/10 border border-green-500/30 rounded-xl text-green-400 text-sm",children:[(0,t.jsx)(o.CheckCircle,{size:16,className:"shrink-0"}),"Username set successfully! Redirecting..."]}),(0,t.jsx)("button",{type:"submit",disabled:"loading"===y||"success"===y,className:"w-full flex items-center justify-center gap-2 py-3.5 rounded-xl bg-blue-600 hover:bg-blue-500 disabled:opacity-60 text-white font-bold shadow-xl shadow-blue-500/30 transition-all hover:-translate-y-0.5 cursor-pointer mt-6",children:"loading"===y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Loader2,{size:18,className:"animate-spin"})," Setting username..."]}):"success"===y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.CheckCircle,{size:18})," Done!"]}):"Continue to Dashboard"})]})]}),(0,t.jsx)(a.motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-center mt-6 text-slate-500 text-xs",children:"Secure sign-in powered by Google OAuth"})]})]})}function h(){return(0,t.jsx)(r.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:(0,t.jsx)(i.Loader2,{size:24,className:"animate-spin text-blue-400"})}),children:(0,t.jsx)(m,{})})}e.s(["default",()=>h],99190)}]);