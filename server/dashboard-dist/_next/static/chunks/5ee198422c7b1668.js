(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,86536,e=>{"use strict";let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],86536)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},37727,e=>{"use strict";let t=(0,e.i(75254).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["X",()=>t],37727)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},16715,e=>{"use strict";let t=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},65351,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(38036),l=e.i(63488),r=e.i(14764),i=e.i(27612),n=e.i(16715),o=e.i(32102),d=e.i(64659),c=e.i(75254);let x=(0,c.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var u=e.i(55436),h=e.i(7233);let m=(0,c.default)("reply",[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]]);var b=e.i(37727),p=e.i(84614);let f=(0,c.default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}]]);var g=e.i(86536),j=e.i(46932),y=e.i(88653);let v={maintenance:{label:"Maintenance Notice",subject:"Scheduled Maintenance Window",body:"Dear user,\n\nWe want to inform you that SysTracker will undergo scheduled maintenance.\n\nStart: [START_TIME]\nEnd: [END_TIME]\n\nDuring this window, the dashboard may be temporarily unavailable. We apologize for any inconvenience.\n\nRegards,\nSysTracker Admin"},machine_offline:{label:"Machine Offline Alert",subject:"Alert: Machine Has Gone Offline",body:"Hello,\n\nThis is an automated alert to inform you that a machine under your account has gone offline.\n\nHostname: [HOSTNAME]\nLast Seen: [LAST_SEEN]\n\nPlease check the agent is running and the machine has internet connectivity.\n\nRegards,\nSysTracker Monitoring"},welcome:{label:"Welcome Message",subject:"Welcome to SysTracker!",body:"Hi [USERNAME],\n\nWelcome to SysTracker â€” your real-time infrastructure monitoring solution.\n\nYour account has been created successfully. You can now:\n- Monitor connected machines\n- View real-time CPU, RAM, and Disk metrics\n- Manage alerts and notifications\n\nIf you have any questions, feel free to reach out.\n\nWelcome aboard!\nSysTracker Team"},alert_critical:{label:"Critical Alert",subject:"Critical System Alert",body:"WARNING: A critical threshold has been detected on one of your monitored machines.\n\nMachine: [HOSTNAME]\nMetric: [METRIC]\nValue: [VALUE]%\n\nPlease investigate immediately to prevent service disruption.\n\nSysTracker Monitoring System"},custom:{label:"Custom Message",subject:"",body:""}};function N(){let[e,c]=(0,s.useState)("inbox"),[N,w]=(0,s.useState)([]),[k,S]=(0,s.useState)(null),[_,M]=(0,s.useState)(!1),[C,T]=(0,s.useState)([]),[z,A]=(0,s.useState)(""),[W,E]=(0,s.useState)(!1),[R,$]=(0,s.useState)(!1),[L,O]=(0,s.useState)({to_user:"",subject:"",body:""}),[P,D]=(0,s.useState)(!1),[U,H]=(0,s.useState)(""),I=(0,s.useCallback)(async()=>{M(!0);try{let t=await (0,a.fetchWithAuth)(`/api/mail?folder=${e}`);t.ok&&w(await t.json())}finally{M(!1)}},[e]);(0,s.useEffect)(()=>{I()},[I]),(0,s.useEffect)(()=>{(0,a.fetchWithAuth)("/api/mail-users").then(e=>e.ok?e.json():[]).then(T).catch(()=>{})},[]);let V=async t=>{S(t),t.is_read||"inbox"!==e||(await (0,a.fetchWithAuth)(`/api/mail/${t.id}`),w(e=>e.map(e=>e.id===t.id?{...e,is_read:1}:e)))},q=async e=>{await (0,a.fetchWithAuth)(`/api/mail/${e}`,{method:"DELETE"}),w(t=>t.filter(t=>t.id!==e)),k?.id===e&&S(null)},B=async()=>{if(!L.to_user||!L.subject||!L.body)return void H("All fields are required.");D(!0),H("");try{let t=await (0,a.fetchWithAuth)("/api/mail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(t.ok)E(!1),O({to_user:"",subject:"",body:""}),"sent"===e&&I();else{let e=await t.json().catch(()=>({error:"Send failed"}));H(e.error||"Send failed")}}finally{D(!1)}},F=e=>{let t=v[e];O(e=>({...e,subject:t.subject||e.subject,body:t.body||e.body})),$(!1)},G=N.filter(e=>e.subject.toLowerCase().includes(z.toLowerCase())||e.from_user.toLowerCase().includes(z.toLowerCase())||e.to_user.toLowerCase().includes(z.toLowerCase()));return(0,t.jsxs)("main",{className:"max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8 pt-6 pb-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-gradient-to-br from-blue-500 to-purple-600 p-3 rounded-2xl shadow-lg shadow-blue-500/25",children:(0,t.jsx)(l.Mail,{className:"text-white",size:24,strokeWidth:2.5})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Mailbox"}),(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"Internal messaging system"})]})]}),(0,t.jsxs)("button",{onClick:()=>{E(!0),O({to_user:"",subject:"",body:""})},className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl text-sm font-semibold hover:shadow-lg hover:shadow-blue-500/30 transition-all duration-200 hover:scale-105",children:[(0,t.jsx)(h.Plus,{size:16,strokeWidth:2.5})," Compose"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[220px_1fr_420px] gap-4",style:{height:"calc(100vh - 200px)"},children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1 p-3 overflow-hidden bg-white/90 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_8px_32px_rgba(0,0,0,0.08)]",children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-400 uppercase px-2 mb-2",children:"Folders"}),["inbox","sent"].map(s=>(0,t.jsxs)("button",{onClick:()=>{c(s),S(null)},className:`flex items-center gap-2.5 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 ${e===s?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg shadow-blue-500/25 scale-105":"text-slate-600 hover:bg-slate-100/60 hover:scale-[1.02]"}`,children:["inbox"===s?(0,t.jsx)(o.Inbox,{size:16,strokeWidth:2.5}):(0,t.jsx)(r.Send,{size:16,strokeWidth:2.5}),s.charAt(0).toUpperCase()+s.slice(1)]},s)),(0,t.jsxs)("div",{className:"mt-4 border-t border-slate-100 pt-3",children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-400 uppercase px-2 mb-2",children:"Quick Templates"}),Object.entries(v).map(([e,s])=>(0,t.jsx)("button",{onClick:()=>{F(e),E(!0)},className:"w-full text-left px-3 py-2 rounded-lg text-xs text-slate-500 hover:bg-slate-100/60 hover:text-slate-700 transition-colors truncate",children:s.label},e))]})]}),(0,t.jsxs)("div",{className:"flex flex-col overflow-hidden bg-white/90 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_8px_32px_rgba(0,0,0,0.08)]",children:[(0,t.jsxs)("div",{className:"px-4 pt-4 pb-2 border-b border-slate-100/60 flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(u.Search,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Search messages...",value:z,onChange:e=>A(e.target.value),className:"w-full pl-8 pr-3 py-2 rounded-xl bg-slate-50/80 border border-slate-200/60 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all duration-200 hover:shadow-sm"})]}),(0,t.jsx)("button",{onClick:I,className:"p-2 hover:bg-gradient-to-br hover:from-blue-50 hover:to-purple-50 rounded-xl text-slate-400 hover:text-blue-500 transition-all duration-200 hover:scale-110",title:"Refresh",children:(0,t.jsx)(n.RefreshCw,{size:15,strokeWidth:2.5,className:_?"animate-spin":""})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto divide-y divide-slate-100/60",children:[_&&0===G.length&&(0,t.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,t.jsx)(n.RefreshCw,{size:20,className:"text-blue-400 animate-spin"})}),!_&&0===G.length&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-32 text-slate-400",children:[(0,t.jsx)(o.Inbox,{size:28,className:"opacity-30 mb-2"}),(0,t.jsx)("p",{className:"text-sm",children:"No messages"})]}),(0,t.jsx)(y.AnimatePresence,{children:G.map(s=>(0,t.jsx)(j.motion.div,{initial:{opacity:0},animate:{opacity:1},onClick:()=>V(s),className:`px-4 py-3 cursor-pointer hover:bg-blue-50/50 transition-all ${k?.id===s.id?"bg-blue-50/80":""}`,children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ${"inbox"===e?"bg-gradient-to-br from-blue-400 to-indigo-500 text-white":"bg-gradient-to-br from-slate-400 to-slate-500 text-white"}`,children:("inbox"===e?s.from_user:s.to_user).slice(0,2).toUpperCase()}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,t.jsx)("p",{className:`text-sm truncate ${!s.is_read&&"inbox"===e?"font-bold text-slate-900":"font-medium text-slate-700"}`,children:"inbox"===e?s.from_user:s.to_user}),(0,t.jsx)("span",{className:"text-xs text-slate-400 shrink-0",children:function(e){let t=Math.floor((Date.now()-new Date(e).getTime())/6e4);if(t<1)return"just now";if(t<60)return`${t}m ago`;let s=Math.floor(t/60);return s<24?`${s}h ago`:`${Math.floor(s/24)}d ago`}(s.created_at)})]}),(0,t.jsx)("p",{className:`text-xs truncate mt-0.5 ${!s.is_read&&"inbox"===e?"text-slate-700 font-semibold":"text-slate-500"}`,children:s.subject})]}),!s.is_read&&"inbox"===e&&(0,t.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-500 shrink-0 mt-2"})]})},s.id))})]})]}),(0,t.jsx)("div",{className:"flex flex-col overflow-hidden bg-white/90 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_8px_32px_rgba(0,0,0,0.08)]",children:k?(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"px-5 pt-5 pb-4 border-b border-slate-100/60",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsx)("h2",{className:"text-base font-bold text-slate-800 leading-snug",children:k.subject}),(0,t.jsxs)("div",{className:"flex gap-1 shrink-0",children:[(0,t.jsx)("button",{onClick:()=>{O({to_user:k.from_user,subject:`Re: ${k.subject}`,body:`

--- Original message from ${k.from_user} ---
${k.body}`}),E(!0)},className:"p-1.5 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded-lg transition-colors",title:"Reply",children:(0,t.jsx)(m,{size:15})}),(0,t.jsx)("button",{onClick:()=>q(k.id),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:(0,t.jsx)(i.Trash2,{size:15})})]})]}),(0,t.jsxs)("div",{className:"mt-2 flex flex-col gap-1 text-xs text-slate-500",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(p.User,{size:11}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-medium",children:"From:"})," ",k.from_user]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(p.User,{size:11}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"font-medium",children:"To:"})," ",k.to_user]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(f,{size:11}),(0,t.jsx)("span",{children:new Date(k.created_at).toLocaleString()})]})]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:(0,t.jsx)("pre",{className:"text-sm text-slate-700 whitespace-pre-wrap font-sans leading-relaxed",children:k.body})})]}):(0,t.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400",children:[(0,t.jsx)("div",{className:"bg-gradient-to-br from-blue-100 to-purple-100 p-6 rounded-2xl mb-4",children:(0,t.jsx)(g.Eye,{size:40,className:"text-blue-500 opacity-60",strokeWidth:2})}),(0,t.jsx)("p",{className:"text-sm font-medium",children:"Select a message to preview"})]})})]}),(0,t.jsx)(y.AnimatePresence,{children:W&&(0,t.jsxs)(j.motion.div,{initial:{opacity:0,y:40,scale:.97},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:40,scale:.97},transition:{type:"spring",stiffness:300,damping:28},className:"fixed bottom-6 right-6 w-[480px] z-50 flex flex-col bg-white/95 backdrop-blur-2xl border border-white/20 rounded-2xl shadow-[0_24px_48px_rgba(0,0,0,0.12)] max-h-[560px]",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-100/60 bg-gradient-to-r from-blue-50/50 to-purple-50/50",children:[(0,t.jsxs)("h3",{className:"text-sm font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent flex items-center gap-2",children:[(0,t.jsx)(r.Send,{size:14,className:"text-blue-500",strokeWidth:2.5})," New Message"]}),(0,t.jsx)("button",{onClick:()=>E(!1),className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg p-1 transition-all duration-200 hover:scale-110",children:(0,t.jsx)(b.X,{size:16,strokeWidth:2.5})})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 px-4 py-3 overflow-y-auto flex-1",children:[(0,t.jsxs)("select",{value:L.to_user,onChange:e=>O(t=>({...t,to_user:e.target.value})),className:"px-3 py-2 rounded-xl border border-slate-200 text-sm bg-slate-50/80 focus:outline-none focus:ring-2 focus:ring-blue-400/30",children:[(0,t.jsx)("option",{value:"",children:"To: Select user..."}),C.map(e=>(0,t.jsx)("option",{value:e.username,children:e.display_name?`${e.display_name} (${e.username})`:e.username},e.username))]}),(0,t.jsx)("input",{type:"text",placeholder:"Subject",value:L.subject,onChange:e=>O(t=>({...t,subject:e.target.value})),className:"px-3 py-2 rounded-xl border border-slate-200 text-sm bg-slate-50/80 focus:outline-none focus:ring-2 focus:ring-blue-400/30"}),(0,t.jsx)("textarea",{rows:8,placeholder:"Write your message...",value:L.body,onChange:e=>O(t=>({...t,body:e.target.value})),className:"px-3 py-2 rounded-xl border border-slate-200 text-sm bg-slate-50/80 focus:outline-none focus:ring-2 focus:ring-blue-400/30 resize-none"}),(0,t.jsxs)("div",{className:"border border-slate-200 rounded-xl overflow-hidden",children:[(0,t.jsxs)("button",{onClick:()=>$(e=>!e),className:"w-full flex items-center justify-between px-3 py-2 text-xs font-medium text-slate-500 hover:bg-slate-50 transition-colors",children:[(0,t.jsx)("span",{children:"Use a template"}),R?(0,t.jsx)(x,{size:13}):(0,t.jsx)(d.ChevronDown,{size:13})]}),(0,t.jsx)(y.AnimatePresence,{children:R&&(0,t.jsx)(j.motion.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-1 px-2 pb-2",children:Object.entries(v).map(([e,s])=>(0,t.jsx)("button",{onClick:()=>F(e),className:"text-left px-2.5 py-2 text-xs rounded-lg bg-slate-50 hover:bg-blue-50 hover:text-blue-700 text-slate-600 transition-colors",children:s.label},e))})})})]}),U&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:U})]}),(0,t.jsx)("div",{className:"px-4 py-3 border-t border-slate-100/60",children:(0,t.jsxs)("button",{onClick:B,disabled:P,className:"w-full flex items-center justify-center gap-2 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl text-sm font-semibold hover:shadow-lg hover:shadow-blue-500/30 disabled:opacity-50 transition-all duration-200 hover:scale-[1.02]",children:[P?(0,t.jsx)(n.RefreshCw,{size:14,strokeWidth:2.5,className:"animate-spin"}):(0,t.jsx)(r.Send,{size:14,strokeWidth:2.5}),P?"Sending...":"Send Message"]})})]})})]})}e.s(["default",()=>N],65351)}]);